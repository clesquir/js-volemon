<template name="tournament">

	<div class="app-section app-section-top tournament-page">

		<div class="app-section-inner maximum-responsive-width">

			<h1 class="tournament-name">
				<a class="back-button" href="{{pathFor 'tournaments'}}">
					<i class="fa fa-arrow-circle-left"></i>
				</a>
				{{tournamentName}}
			</h1>
			<p class="tournament-description">{{tournamentDescription}}</p>

			{{#if currentUser}}
				{{#if tournamentIsActiveAndHasRetries}}
					<div class="tournament-retries-container">
						<div class="retries-availables">
							{{#each retriesAvailables}}
								<div class="retry">
									<div class="{{#if lost}}retry-lost{{/if}}">x</div>
								</div>
							{{/each}}
						</div>
					</div>
				{{/if}}
			{{/if}}

			{{#if canPlayTournament}}
				<a href="#" class="play-game-button button" data-action="play-tournament-game">Play</a>
			{{/if}}

			<div id="tournament-contents" class="view-selector-contents {{#if isTournamentActive}}tournament-games-shown{{else}}tournament-statistics-shown{{/if}}">
				<div class="view-selector swiper-selector">
					{{#if isTournamentActive}}
						<i class="icomoon icon-tv view-tournament-games" data-action="view-tournament-games" data-tooltip="Watch games"></i>
					{{/if}}
					<i class="fa fa-pie-chart view-tournament-statistics" data-action="view-tournament-statistics" data-tooltip="Statistics"></i>
					<i class="fa fa-hashtag view-tournament-rank" data-action="view-tournament-rank" data-tooltip="Rank"></i>
					<i class="fa fa-line-chart view-tournament-line-chart" data-action="view-tournament-line-chart" data-tooltip="ELO line chart"></i>
				</div>

				<div class="swiper-container tournament-swiper-container">
					<div class="swiper-wrapper">
						{{#if isTournamentActive}}
							<div class="view-selector-content swiper-slide tournament-games" data-slide="tournament-games">
								<h2 class="games-list-header">
									<div>Watch games</div>
								</h2>

								<p>These are the tournament games you can watch</p>

								{{> gamesList games=tournamentGames showTournamentName=false}}
							</div>
						{{/if}}

						<div class="view-selector-content swiper-slide tournament-statistics" data-slide="tournament-statistics">
							<h2>Statistics</h2>

							{{#if currentUser}}
								{{> statistics tournamentId=tournament._id}}
							{{else}}
								<p>Please <a class="clickable-link" data-action="user-log-in">log in</a> to get statistics on your profile for this tournament!</p>
							{{/if}}
						</div>

						<div class="view-selector-content swiper-slide tournament-rank" data-slide="tournament-rank">
							<h2>Rank</h2>

							{{> eloRanking rankings=getRankings emptyText="Nobody played this tournament yet..." tournamentId=tournament._id}}
						</div>

						<div class="view-selector-content swiper-slide tournament-line-chart" data-slide="tournament-line-chart">
							{{> loading loadingMask="lineChartDisplayLoadingMask"}}

							<h2>ELO line chart</h2>

							<div>
								<div id="rank-line-chart">
									<canvas id="rank-line-chart-canvas"></canvas>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>

	</div>

</template>
